<div class="row gap container">
    <div class="row gap container" id="projects">
        
    </div>
    <button id="createProject">
        Создать проект
    </button>
    <dialog id="createBoardDialog" class="classicModal">
        <div class="column gap">
            <input id="boardName"/>
            <div class="row gap justCenter alignCenter">
                <button class="classicButton" id="createBoard">
                    Создать проект
                </button>
                <button class="classicButton" onclick="closeBoardCreateDialog()">
                    отмена
                </button>
            </div>
        </div>
    </dialog>
</div>

<script type="module">
    import {post} from "./src/Core/Api/Api.js";
    import boardListStore from "./src/Stores/BoardListStore.js";


    function loadProjects(item, first){
        let projects = document.querySelector("#projects");
        if(first) projects.innerHTML = "";
        let project = document.createElement('propject-board');
        project.setAttribute("name", item.name);
        project.setAttribute("entity", item.id);
        projects.appendChild(project);
    }

    boardListStore.subscribers.push(loadProjects);
    boardListStore.load({});

    async function createProject(){
        const dialog = document.querySelector("#createBoardDialog");
        const name = dialog.querySelector("#boardName").value;
        const data = await post("/board/createboard", {name:name});
        await boardListStore.load({});
        dialog.close();
    }

    function openDialog(){
        const dialog = document.querySelector("#createBoardDialog");
        dialog.showModal();
    }

    let openButton = document.querySelector("#createProject");
    openButton.addEventListener("click", openDialog);

    let createButton = document.querySelector("#createBoard");
    createButton.addEventListener("click", createProject);
</script>

<script>
    function closeBoardCreateDialog(){
        const dialog = document.querySelector("#createBoardDialog");
        dialog.close();
    }
</script>